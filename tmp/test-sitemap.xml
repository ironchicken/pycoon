<?xml version="1.0" encoding="utf-8" ?>

<site-map document-root="/home/richard/Documents/python/pycoon/tmp">

<pipelines>

<pipeline>
  <match type="uri" pattern="/">
    <generate type="directory-list" src="." />
    <serialize type="xml" />
  </match>

  <match type="uri" pattern="/list/*-*">
    <generate type="xpath" src="data.xml" query="//item[position()&gt;={$1} and position()&lt;={$2}]" />
    <serialize type="xml" />
  </match>

  <match type="uri" pattern="/bigitup">
    <aggregate>
      <generate type="directory-list" src="." />
      <select type="resource-exists" method="inclusive">
	<when test="data.xml">
	  <generate type="xpath" src="data.xml" query="//item[position()&gt;=1 and position()&lt;=5]" />
	</when>
	<when test="browsers.xml">
	  <generate type="file" src="browsers.xml" />
	</when>
      </select>
    </aggregate>
    <serialize type="xml" />
  </match>

  <match type="uri" pattern="/browser">
    <generate type="file" src="browsers.xml" />
    <select type="browser">
      <when test="konqueror">
	<transform type="xslt" src="browsers2html.xslt">
	  <parameter name="browser" value="Konqueror" />
	</transform>
      </when>
      <when test="msie">
	<throw error-code="404" />
      </when>
      <when test="firefox galeon">
	<transform type="xslt" src="browsers2html.xslt">
	  <parameter name="browser" value="Firefox or Galeon" />
	</transform>
      </when>
      <otherwise>
	<transform type="xslt" src="browsers2html.xslt">
	  <parameter name="browser" value="unknown" />
	</transform>
      </otherwise>
    </select>
    <serialize type="xhtml" />
  </match>

  <match type="uri" pattern="/query">
    <select type="request-parameter" parameter="document">
      <when test="data">
	<generate type="file" src="data.xml" />
      </when>
      <when test="browsers">
	<generate type="file" src="browsers.xml" />
      </when>
    </select>
    <serialize type="xml" />
  </match>

  <match type="uri" pattern="/sara-artist" required-parameters="id">
    <generate type="http" src="http://www.sara.uea.ac.uk/body.php">
      <parameter name="body" value="display-artist" />
      <parameter name="artist_id" value="{uri:query:id}" />
      <parameter name="format" value="XML" />
    </generate>
    <serialize type="xml" />
  </match>

  <match type="uri" pattern="/*">
    <generate type="file" src="data.xml" />
    <transform type="xslt" src="data2html.xslt">
      <parameter name="uri" value="{$1}" />
    </transform>
    <select type="browser-class">
      <when test="graphic">
	<serialize type="xhtml" mime="text/html" />
      </when>
      <otherwise>
	<serialize type="html" mime="text/html" />
      </otherwise>
    </select>
  </match>

  <match type="uri" pattern="/cmd/*">
    <generate type="command" src="cat data.xml" />
    <transform type="command" src="sabcmd data2html.xslt" />
    <serialize type="html" />
  </match>

  <match type="error" error-code="404">
    <generate type="file" src="not-found.xml" />
    <serialize type="xml" />
  </match>
</pipeline>

</pipelines>

</site-map>
