<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Pycoon White Paper</title>
  <meta name="author" content="Richard Lewis" />
  
  <meta name="created" content="2006-10-10" />
  <meta name="modified" content="2006-11-12" />
<style type="text/css">
td{vertical-align:top;padding:3px}
  </style></head>
  <body><h1>Pycoon White Paper</h1><p><small style="display:block">Richard Lewis</small><small style="display:block">Modified: 2006-11-12</small></p><hr />

<div id="introduction"><h2>Introduction</h2>
  <p>
    This white paper details the implementation of an XML web publishing framework written in the
    <a href="http://www.python.org/">Python</a> programming language, based on the concept of
    XML <a href="http://en.wikipedia.org/wiki/XML_pipeline">pipeline</a> processing and
    similar in intention to the <a href="http://cocoon.apache.org/">Apache Cocoon</a> project.
  </p>
  <p>
    There were two main reasons for my choosing to attempt to write an XML web publishing framework:
    first was that I was not happy with the Java-based approach used in Apache Cocoon and its
    reliance on a Java Servlet engine; and second was that I felt I would benefit from the technical
    challenge.
  </p>
</div>

<div id="aims"><h2>Project Aims</h2>
  <p>
    The main aims of the Pycoon project are to implement an XML web publishing framework which:
  </p>
  <ul>
    <li>
      Feels very familiar to Cocoon users; uses the 'sitemap' concept and similarly named components
    </li>
    <li>
      Integrates well with the Apache web server
    </li>
    <li>
      Allows experienced Python programmers to write their own components
    </li>
    <li>
      Attempts to maintain a small code footprint and stays manageable
    </li>
    <li>
      Is reasonably light on system resources
    </li>
  </ul>
</div>

<div id="deployment"><h2>Deployment</h2>
  <p>
    Pycoon is deployed as mod_python handler in Apache. It has been tested as a VirtualHost handler,
    though would probably work as a handler for the whole Apache server (at the expense of being
    able to do anything else with the server - including serving ordinary files!) and may work as a
    directory handler but it would be necessary to use the absolute URI path in matcher patterns.
  </p>
  <p>
    The required Apache VirtualHost configuration should follow this format:
  </p>
  <pre>
    &lt;VirtualHost *&gt;
    ServerName localhost
    DocumentRoot /var/www

    SetHandler mod_python
    PythonPath 'sys.path+["/var/www/"]'

    SetEnv PycoonConfigRoot /etc/pycoon
    SetEnv PycoonSitemap sitemap.xm

    PythonHandler pycoon
    &lt;/VirtualHost&gt;
  </pre>
  <p>
    The PycoonConfigRoot and PycoonSitemap variables are optional and the values shown above are
    also the default values. The PycoonConfigRoot directory should contain the server.xml file and
    the resources directory (see conf in the svn trunk).
  </p>
  <p>
    The server.xml file contains the configuration information for the Pycoon server, including:
    logging level; server owner details; caching options (though caching is not yet implemented);
    available pipeline components; and some default pipelines intended to be used for error
    handling.
  </p>
</div>

<div id="implementation"><h2>Implementation</h2>
  <p>
    The two main tools which were assumed at the outset were the <a href="http://www.python.org/">Python</a> programming language and the <a href="http://httpd.apache.org/">Apache</a> web server. As a result of these decisions, it was
    logical to choose to use <a href="http://www.modpython.org/">mod_python</a> to link the
    two technologies.
  </p>
  <p>
    The concept of the 'sitemap' XML file for describing pipelines was taken from Cocoon and an
    attempt has been made to adopt a similar sitemap syntax in Pycoon.
  </p>
  <p>
    The component based architecture, as well as being a feature of Cocoon, is typical of many
    programming projects that aim towards extensibility. The classes of components implemented
    (including 'matchers', 'selectors', 'generators', 'transformers' and 'serializers') have been
    chosen for their familiarity to Cocoon users but they are also practical and descriptive names
    for the concepts they encapsulate.
  </p>
  <p>
    Where Cocoon handles XML data as SAX events through its pipelines, Pycoon uses the <a href="http://http://effbot.org/zone/element-index.htm">ElementTree</a> interface (though with
    the <a href="http://codespeak.net/lxml/">lxml</a> implementation) to store the current
    state of the XML pipeline and manipulate it at each stage. This may be a less efficient method
    than SAX event streams, especially for larger quantities of data, but it does have the advantage
    of allowing for much simpler code; it is easier to construct and manipulate ElementTree data in
    Python than it is to construct and manipulate SAX events.
  </p>

<div id="class-hierarchy"><h3>Component Class Hierarchy</h3>
  <p>
    This diagram shows the component hierarchy and all the currently implemented components:
  </p>

  <div id="component-class-hierarchy-diagram"><ul>
    <li><a style="font-weight:bold" href="#class-component">component</a>: Component base class<ul>
      <li><a style="font-weight:bold" href="#class-pipeline">pipeline</a>: The container class for components which provides 'execution' methods</li>
      <li><a style="font-weight:bold" href="#class-syntax_component">syntax_component</a>: Base class of all components which handle logical processing in sitemaps<ul>
	<li><a style="font-weight:bold" href="#class-matcher">matcher</a>: Matcher base class<ul>
	  <li><a style="font-weight:bold" href="#class-uri_matcher">uri_matcher</a>: Allows pipeline processing to be conditional on URI patterns</li>
	  <li><a style="font-weight:bold" href="#class-error_matcher">error_matcher</a>: Allows pipeline processing to be conditional on HTTP error conditions</li>
	</ul></li>
	<li><a style="font-weight:bold" href="#class-selector">selector</a>: Selector base class<ul>
	  <li><a style="font-weight:bold" href="#class-browser_class_selector">browser_class_selector</a>: Allows pipeline processing to be conditional on the type of browser the client is using [graphic|text|aural|braille]</li>
	  <li><a style="font-weight:bold" href="#class-browser_selector">browser_selector</a>: Allows pipeline processing to be conditional the name of the browser the client is using</li>
	  <li><a style="font-weight:bold" href="#class-request_parameter_selector">request_parameter_selector</a>: Allows pipeline processing to be conditional on the value of a request parameter (either GET or POST)</li>
	  <li><a style="font-weight:bold" href="#class-request_header_selector">request_header_selector</a>: Allows pipeline processing to be conditional on the value of a request header</li>
	  <li><a style="font-weight:bold" href="#class-resource_exists_selector">resource_exists_selector</a>: Allows pipeline processing to be conditional on the existence of a file</li>
	</ul></li>
	<li><a style="font-weight:bold" href="#class-parameter">parameter</a>: Used to pass parameters to any components which require them</li>
	<li><a style="font-weight:bold" href="#class-when">when</a>: Used to implement the conditions of selector components</li>
	<li><a style="font-weight:bold" href="#class-otherwise">otherwise</a>: Used to implement the default condition of selector components</li>
	<li><a style="font-weight:bold" href="#class-throw">throw</a>: Causes an HTTP error code</li>
	<li><a style="font-weight:bold" href="#class-redirect">redirect</a>: Causes the request to be redirected to another URI</li>
      </ul></li>
      <li><a style="font-weight:bold" href="#class-stream_component">stream_component</a>: Base class for all components which handle XML data in a pipeline<ul>
	<li><a style="font-weight:bold" href="#class-read">read</a>: Returns an ordinary file (without any XML processing)</li>
	<li><a style="font-weight:bold" href="#class-generator">generator</a>: Generator base class<ul>
	  <li><a style="font-weight:bold" href="#class-xml_generator">xml_generator</a>: Use an XML file to provide the source XML for a pipeline</li>
	  <li><a style="font-weight:bold" href="#class-http_generator">http_generator</a>: Retrieve the source XML for a pipeline using an HTTP request</li>
	  <li><a style="font-weight:bold" href="#class-xpath_generator">xpath_generator</a>: Execute an XPath expression against an XML file to provide the source XML for a pipeline</li>
	  <li><a style="font-weight:bold" href="#class-aggregate_generator">aggregate_generator</a>: The child generators' results are aggregated to provide the source XML for a pipeline</li>
	  <li><a style="font-weight:bold" href="#class-command_generator">command_generator</a>: The stdout stream from a shell command provides the source XML for a pipeline</li>
	  <li><a style="font-weight:bold" href="#class-directory_generator">directory_generator</a>: Converts a directory listing into the source XML for a pipeline</li>
	  <li><a style="font-weight:bold" href="#class-request_generator">request_generator</a>: Encodes the given request headers as the XML source for a pipeline</li>
	  <li><a style="font-weight:bold" href="#class-xquery_generator">xquery_generator</a>: Execute an XQuery expression against an XML database (Berkelely DB XML) to provide the source XML for a pipeline</li>
	  <li><a style="font-weight:bold" href="#class-sql_generator">sql_generator</a>: Execute an SQL query against a database to provide the source XML for a pipeline</li>
	  <li><a style="font-weight:bold" href="#class-swishe_generator">swishe_generator</a>: Execute a full-text search against a Swish-e index to provide the source XML for a pipeline</li>
	</ul></li>
	<li><a style="font-weight:bold" href="#class-transformer">transformer</a>: Transformer base class<ul>
	  <li><a style="font-weight:bold" href="#class-xslt_transformer">xslt_transformer</a>: Transform the pipeline XML stream using an XSLT stylesheet</li>
	  <li><a style="font-weight:bold" href="#class-command_transformer">command_transformer</a>: Transform the pipeline XML stream using a shell command</li>
	  <li><a style="font-weight:bold" href="#class-sax_handler_transformer">sax_handler_transformer</a>: Transform the pipeline XML stream using a Python SAX handler class</li>
	  <li><a style="font-weight:bold" href="#class-etree_transformer">etree_transformer</a>: Transform the pipeline XML stream using Python code which directly manipulates the ElementTree</li>
	</ul></li>
	<li><a style="font-weight:bold" href="#class-serializer">serializer</a>: Serializer base class<ul>
	  <li><a style="font-weight:bold" href="#class-html_serializer">html_serializer</a>: Convert the pipeline XML stream into an HTML document</li>
	  <li><a style="font-weight:bold" href="#class-xhtml_serializer">xhtml_serializer</a>: Convert the pipeline XML stream into an XHTML document</li>
	  <li><a style="font-weight:bold" href="#class-xml_serializer">xml_serializer</a>: Convert the pipeline XML stream into an XML document</li>
	  <li><a style="font-weight:bold" href="#class-text_serializer">text_serializer</a>: Convert the pipeline XML stream into a plain text document</li>
	  <li><a style="font-weight:bold" href="#class-pdf_serializer">pdf_serializer</a>: Convert the pipeline XML stream (which must contain XSL-FO) into a PDF document (NOT IMPLEMENTED)</li>
	  <li><a style="font-weight:bold" href="#class-svg_serializer">svg_serializer</a>: Convert the pipeline XML stream (which must contain SVG) into an image (PARTIAL IMPLEMENTATION)</li>
	</ul></li>
      </ul></li>
    </ul></li>
  </ul></div>

  <p>
    These are the non-component classes used in Pycoon:
  </p>

  <div id="non-component-class-hierarchy-diagram"><ul>
    <li><a style="font-weight:bold" href="#class-sitemap_config">sitemap_config</a>: The container class for pipelines</li>
    <li><a style="font-weight:bold" href="#class-sitemap_config_parse">sitemap_config_parse</a>: A SAX handler which reads a sitemap file</li>
    <li><a style="font-weight:bold" href="#class-server_config">server_config</a>: Holds information for a Pycoon instance</li>
    <li><a style="font-weight:bold" href="#class-server_config_parse">server_config_parse</a>: A SAX handler which reads a server configuration file</li>
    <li><a style="font-weight:bold" href="#class-invokation_syntax">invokation_syntax</a>: Stores the syntax required to use a component in a sitemap file</li>
    <li><a style="font-weight:bold" href="#class-interpolation_syntax">interpolation_syntax</a>: Provides a method to interpret special {} delimited portions of component attribute values in sitemap files<ul>
      <li><a style="font-weight:bold" href="#class-interpolate_pattern_match_number">interpolate_pattern_match_number</a>: Interprets the '{$n}' syntax, where the number 'n' is the n'th '*' denoted portion of the URI</li>
      <li><a style="font-weight:bold" href="#class-interpolate_uri">interpolate_uri</a>: Interprets the '{uri:...}' syntax</li>
      <li><a style="font-weight:bold" href="#class-interpolate_context">interpolate_context</a>: Interpolate_context interprets the '{context:...}' syntax, where '...' should be a URI which will be handled by the sitemap and its result will be returned</li>
      <li><a style="font-weight:bold" href="#class-interpolate_traceback">interpolate_traceback</a>: Interprets the '{traceback}' syntax and returns the current traceback as a string</li>
    </ul></li>
  </ul></div>
</div>

<div id="class-descriptions"><h3>Class Descriptions</h3>
  
<div class="class" id="class-component" style="border-top:1px solid #000000;border-bottom:1px solid #000000;margin-top:5px"><div style="font-size:120%;font-style:italic;margin-top:10px;margin-bottom:10px">component</div><table><tr><td style="font-weight:bold">source</td><td style="font-family:monospace;background-color:#FFF0D8">pycoon/components.py</td></tr></table><p>
    The component class is the base class of all pipeline components in Pycoon.
  </p><div id="class-component-method-__init__" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">__init__(self, parent, root_path="")</div><div style="margin-left:15px">
      <p>
	Class constructor. <span style="font-style:italic">parent</span> is the component's parent in the pipeline
	and may be another component or a <a href="#class-pipeline">pipeline</a> or <a href="#class-sitemap">sitemap</a> object. <span style="font-style:italic">root_path</span> is a base path
	which derived components should use to resolve path names; it is an optional parameter and
	takes the value of the parent sitemap (or server) document root if not specified.
      </p>
    </div></div><div id="class-component-method-__call__" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">__call__(self, req, p_sibling_result=None, child_results=[])</div><table style="margin-left:15px"><tr><td style="font-weight:bold">returns</td><td style="background-color:#FFF0D8">
      Returns a tuple whose first member is a boolean flag indicating whether the execution was
      successful or not and whose second member is the <span style="font-style:italic">Element</span> result.
    </td></tr></table><div style="margin-left:15px">
      <p>
	Main execution method. <span style="font-style:italic">req</span> is an Apache request
	object. <span style="font-style:italic">p_sibling_result</span> is the <span style="font-style:italic">Element</span>
	returned by the previous sibling component in the pipeline.
	<span style="font-style:italic">child_results</span> is a list of the <span style="font-style:italic">Element</span>
	results of all the child componets which have been executed so far.
      </p>
      <p>
	This method first calls the object's <a href="#class-component-method-_descend">_descend</a> method and, if it returns <span style="font-style:italic">True</span>,
	it loops over the component's child components and calls each one's __call__ method, passing
	the previous child's result as the <span style="font-style:italic">p_sibling_result</span> each time.
      </p>
    </div></div><div id="class-component-method-_descend" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">_descend(self, req, p_sibling_result=None)</div><table style="margin-left:15px"><tr><td style="font-weight:bold">returns</td><td style="background-color:#FFF0D8">
      Returns a boolean.
    </td></tr></table><div style="margin-left:15px">
      <p>
	<span style="font-style:italic">req</span> is an Apache request
	object. <span style="font-style:italic">p_sibling_result</span> is the <span style="font-style:italic">Element</span>
	returned by the previous sibling component in the pipeline.
      </p>
      <p>
	The _descend method allows derived components to give permission for their child components
	to be executed or not. It is passed the current query context (the request object) and the
	result of its previous sibling which implementations can use to determine the return
	value. Its default behaviour is simply to return True. However, components such as <a href="#class-matcher">matchers</a> and <a href="#class-selector">selectors</a> need to override
	this method.
      </p>
    </div></div><div id="class-component-method-_continue" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">_continue(self, req, p_sibling_result=None)</div><table style="margin-left:15px"><tr><td style="font-weight:bold">returns</td><td style="background-color:#FFF0D8">
      Returns a boolean.
    </td></tr></table><div style="margin-left:15px">
      <p>
	<span style="font-style:italic">req</span> is an Apache request
	object. <span style="font-style:italic">p_sibling_result</span> is the <span style="font-style:italic">Element</span>
	returned by the previous sibling component in the pipeline.
      </p>
      <p>
	The _continue method is similar to the <a href="#class-component-method-_descend">_descend</a> method: it allows derived components to give permission
	for their following sibling components to be executed or not. It is passed the current query
	context (the request object) and the result of its previous sibling which implementations
	can use to determine the return value. Its default behaviour is simply to return
	True. However, components such as the <a href="#class-when">when</a> component need to
	override this method and the <a href="#class-uri_matcher">uri_matcher</a> overrides it to
	improve efficientcy (once a matching URI pattern has been found and its components executed,
	no further pipeline processing is carried out).
      </p>
    </div></div><div id="class-component-method-_result" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">_result(self, req, p_sibling_result=None, child_results=[])</div><table style="margin-left:15px"><tr><td style="font-weight:bold">returns</td><td style="background-color:#FFF0D8">
      Returns a tuple whose first member is a boolean flag indicating whether the execution was
      successful or not and whose second member is the <span style="font-style:italic">Element</span> result.
    </td></tr></table><div style="margin-left:15px">
      <p>
	XML data handling components should do their main work in this
	method. <span style="font-style:italic">req</span> is an Apache request
	object. <span style="font-style:italic">p_sibling_result</span> is the <span style="font-style:italic">Element</span>
	returned by the previous sibling component in the
	pipeline. <span style="font-style:italic">child_results</span> is a list of the
	<span style="font-style:italic">Element</span> results of all this component's child componets.
      </p>
      <p>
	The default implementation raises a <span style="font-style:italic">NotImplemented</span> exception. All
	derived components should perform their main function in this method (or at least from this
	method) and return a tuple whose first member is a boolean indicating whether or not they
	were successful and whose second member, on success, should be an
	<span style="font-style:italic">Element</span> object, or, on failure, an Apache error code. (Note,
	however, that exceptions will be handled gracefully by Pycoon and result in a descriptive
	HTTP 500 error.)
      </p>
    </div></div><div id="class-component-method-add_component" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">add_component(self, c, pos=None)</div><table style="margin-left:15px"><tr><td style="font-weight:bold">returns</td><td style="background-color:#FFF0D8">
      The added component
    </td></tr></table><div style="margin-left:15px">
      <p>
	Add a child component. <span style="font-style:italic">c</span> is a component
	object. <span style="font-style:italic">pos</span> is the position, expressed as a number, at which the
	component should be added; by default the component is appended as the last child component.
      </p>
    </div></div><div id="class-component-method-parameter_children" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">parameter_children(self, child_results)</div><table style="margin-left:15px"><tr><td style="font-weight:bold">returns</td><td style="background-color:#FFF0D8">
      A dictionary
    </td></tr></table><div style="margin-left:15px">
      <p>
	Converts <a href="#class-parameter">parameter</a> child components into a dictionary of
	name/value pairs. <span style="font-style:italic">child_results</span> is a list of parameter components.
	(Note: the current implementation of this function is quite naive in that it performs
	inadequate type checking on the given child_results and relies on sitemap class's syntax
	checking to make sure that child components will actually be parameters).
      </p>
    </div></div><div id="class-component-method-find_components" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">find_components(self, class_name, found=[])</div><table style="margin-left:15px"><tr><td style="font-weight:bold">returns</td><td style="background-color:#FFF0D8">
      A list of components (may be empty)
    </td></tr></table><div style="margin-left:15px">
      <p>
	Searches all of this component's child components and returns any whose class name matches
	the given <span style="font-style:italic">class_name</span>. It is a recursive function so the
	<span style="font-style:italic">found</span> parameter is simply the list of matching components found by
	the previous call.
      </p>
      <p>
	This function is most effectively used by the <a href="#class-pipeline">pipeline</a>
	component as it has the most children. It is used by the pipeline component's <a href="#class-pipeline-method-handle_error">handle_error</a> method to find available <a href="#class-error_matcher">error_matcher</a> components.
      </p>
    </div></div><div id="class-component-property-parent" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">parent</div>
    <div style="margin-left:15px">
      The parent component of this component.
    </div>
  </div><div id="class-component-property-sitemap" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">sitemap</div>
    <div style="margin-left:15px">
      The parent sitemap of this component.
    </div>
  </div><div id="class-component-property-server" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">server</div>
    <div style="margin-left:15px">
      The parent server of this component.
    </div>
  </div><div id="class-component-property-context" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">context</div>
    <div style="margin-left:15px">
      Either a reference to the compoent's parent sitemap or, if this is None, the component's
      parent server.
    </div>
  </div><div id="class-component-property-root_path" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">root_path</div>
    <div style="margin-left:15px">
      The base path which should be prefixed to any filenames used by the component. By default, it
      takes either the sitemap or server's document root.
    </div>
  </div><div id="class-component-property-children" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">children</div>
    <div style="margin-left:15px">
      A list of child components.
    </div>
  </div><div id="class-component-property-description" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">description</div>
    <div style="margin-left:15px">
      A short string describing the component. In derived components, the parameters (such as URI
      pattern) are added to this description to improve debugging information.
    </div>
  </div><div id="class-component-class_property-role" style="margin-bottom:5px;background-color:#FFEBE6">
    <div style="font-weight:bold">role</div><div style="margin-left:15px;margin-top:5px;font-style:italic">class property</div>
    <div style="margin-left:15px">
      Should be either "stream" or "syntax". For component class the value is "none".
    </div>
  </div><div id="class-component-class_property-function" style="margin-bottom:5px;background-color:#FFEBE6">
    <div style="font-weight:bold">function</div><div style="margin-left:15px;margin-top:5px;font-style:italic">class property</div>
    <div style="margin-left:15px">
      Should be one of "matcher", "selector", "generator", "transformer", "serializer", etc.  For
      component class the value is "none".
    </div>
  </div><div id="class-component-helper_func-register_component" style="margin-bottom:5px;background-color:#E0DEFF">
    <div style="font-weight:bold">register_component(server, super_type, attrs)</div><div style="margin-left:15px;margin-top:5px;font-style:italic">helper function</div>
    <div style="margin-left:15px">
      <p>
	Loads a component class for later use by sitemaps. <span style="font-style:italic">server</span> is the
	server object; <span style="font-style:italic">super_type</span> is one of "matcher", "generator",
	"transformer", etc.; <span style="font-style:italic">attrs</span> is an
	<span style="font-style:italic">xml.sax.xmlreader.AttributesImpl</span> which contains the attributes
	supplied by the server configuration file for the component (normally "name", "module" and
	"class").
      </p>
    </div>
  </div></div>

<div class="class" id="class-invokation_syntax" style="border-top:1px solid #000000;border-bottom:1px solid #000000;margin-top:5px"><div style="font-size:120%;font-style:italic;margin-top:10px;margin-bottom:10px">invokation_syntax</div><table><tr><td style="font-weight:bold">source</td><td style="font-family:monospace;background-color:#FFF0D8">pycoon/components.py</td></tr></table><p>
    Used to store the XML syntax rules for how a component should be used in a sitemap file.
  </p><div id="class-invokation_syntax-method-__init__" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">__init__(self)</div><div style="margin-left:15px">
      <p>
	Class constructor. Creates empty instance properties.
      </p>
    </div></div><div id="class-invokation_syntax-method-validate" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">validate(self, parent_name, name, attrs)</div><table style="margin-left:15px"><tr><td style="font-weight:bold">returns</td><td style="background-color:#FFF0D8">
      Returns a boolean
    </td></tr></table><div style="margin-left:15px">
      <p>
	Checks the given XML element attributes for validity. <span style="font-style:italic">parent_name</span>
	is the element name of the parent component; <span style="font-style:italic">name</span> is the element
	name of the element being checked; <span style="font-style:italic">attrs</span> is an
	<span style="font-style:italic">xml.sax.xmlreader.AttributesImpl</span> instance from the sitemap element
	being checked.
      </p>
      <p>
	The method raises exceptions on any syntax errors in the component usage. If there are no
	errors it returns True.
      </p>
    </div></div><div id="class-invokation_syntax-property-element_name" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">element_name</div>
    <div style="margin-left:15px">
      The required element name for the component.
    </div>
  </div><div id="class-invokation_syntax-property-allowed_parent_components" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">allowed_parent_components</div>
    <div style="margin-left:15px">
      A list of the element names of components of the components of which this component may be a
      child.
    </div>
  </div><div id="class-invokation_syntax-property-required_attribs" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">required_attribs</div>
    <div style="margin-left:15px">
      A list of the names of required XML attributes for the component.
    </div>
  </div><div id="class-invokation_syntax-property-required_attrib_values" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">required_attrib_values</div>
    <div style="margin-left:15px">
      A dictionary of name/value pairs of the required values of XML attributes of the component.
    </div>
  </div><div id="class-invokation_syntax-property-optional_attribs" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">optional_attribs</div>
    <div style="margin-left:15px">
      A list of the names of optional XML attributes for the component.
    </div>
  </div><div id="class-invokation_syntax-property-allowed_child_components" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">allowed_child_components</div>
    <div style="margin-left:15px">
      A list of the element names of components which are allowed to be child components of this
      component.
    </div>
  </div></div>

<div class="class" id="class-syntax_component" style="border-top:1px solid #000000;border-bottom:1px solid #000000;margin-top:5px"><div style="font-size:120%;font-style:italic;margin-top:10px;margin-bottom:10px">syntax_component</div><table><tr><td style="font-weight:bold">inherits</td><td style="background-color:#FFF0D8"><a href="#class-component">component</a></td></tr><tr><td style="font-weight:bold">source</td><td style="font-family:monospace;background-color:#FFF0D8">pycoon/components.py</td></tr></table><p>
    Base class of all components which handle logical processing in sitemaps.
  </p><div id="class-syntax_component-class_property-role" style="margin-bottom:5px;background-color:#FFEBE6">
    <div style="font-weight:bold">role</div><div style="margin-left:15px;margin-top:5px;font-style:italic">class property</div>
    <div style="margin-left:15px">
      For syntax_component class the value is "syntax".
    </div>
  </div><div id="class-syntax_component-method-__init__" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">__init__(self, parent, root_path="")</div><table style="margin-left:15px"><tr><td style="font-weight:bold">overrides</td><td style="background-color:#FFF0D8"><a href="#class-component-method-__init__">component.__init__</a></td></tr></table><div style="margin-left:15px">
      <p>
	Calls <a href="#class-component-method-_result">component.__init__</a> and sets <a href="#class-syntax_component-property-description">description</a> property to "Syntax
	component base class".
      </p>
    </div></div><div id="class-syntax_component-method-_result" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">_result(self, req, p_sibling_result=None, child_results=[])</div><table style="margin-left:15px"><tr><td style="font-weight:bold">overrides</td><td style="background-color:#FFF0D8"><a href="#class-component-method-_result">component._result</a></td></tr><tr><td style="font-weight:bold">returns</td><td style="background-color:#FFF0D8">
      Returns a tuple whose first member is a boolean flag indicating whether the execution was
      successful or not and whose second member is the <span style="font-style:italic">Element</span> result.
    </td></tr></table><div style="margin-left:15px">
      <p>
	This default implementation for syntax components simply either returns the last
	<span style="font-style:italic">child_results</span> <span style="font-style:italic">Element</span> (if there is one) or
	the <span style="font-style:italic">p_sibling_result</span> along with a True success flag.
      </p>
    </div></div></div>

<div class="class" id="class-matcher" style="border-top:1px solid #000000;border-bottom:1px solid #000000;margin-top:5px"><div style="font-size:120%;font-style:italic;margin-top:10px;margin-bottom:10px">matcher</div><table><tr><td style="font-weight:bold">inherits</td><td style="background-color:#FFF0D8"><a href="#class-syntax_component">syntax_component</a></td></tr><tr><td style="font-weight:bold">source</td><td style="font-family:monospace;background-color:#FFF0D8">pycoon/matchers/__init__.py</td></tr></table><p>
    Base class for matcher components.
  </p><div style="font-weight:bold">syntax</div><pre>
    &lt;!ELEMENT pipeline (match*)&gt;
    &lt;!ELEMENT match (select*,aggregate*,generate*,transform*,serialize?)&gt;
    &lt;!ATTLIST match type CDATA #REQUIRED&gt;
  </pre><div id="class-matcher-method-__init__" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">__init__(self, parent, root_path="")</div><table style="margin-left:15px"><tr><td style="font-weight:bold">overrides</td><td style="background-color:#FFF0D8"><a href="#class-syntax_component-method-_result">syntax_component.__init__</a></td></tr></table><div style="margin-left:15px">
      <p>
	Calls <a href="#class-syntax_component-method-_result">syntax_component.__init__</a> and
	sets <a href="#class-matcher-property-description">description</a> property to "Matcher
	bass class".
      </p>
    </div></div></div>

<div class="class" id="class-selector" style="border-top:1px solid #000000;border-bottom:1px solid #000000;margin-top:5px"><div style="font-size:120%;font-style:italic;margin-top:10px;margin-bottom:10px">selector</div><table><tr><td style="font-weight:bold">inherits</td><td style="background-color:#FFF0D8"><a href="#class-syntax_component">syntax_component</a></td></tr><tr><td style="font-weight:bold">source</td><td style="font-family:monospace;background-color:#FFF0D8">pycoon/selectors/__init__.py</td></tr></table><p>
    Base class for selector components.
  </p><div style="font-weight:bold">syntax</div><pre>
    &lt;!ELEMENT match (select*,...)&gt;
    &lt;!ELEMENT aggregate (select*,...)&gt;
    &lt;!ELEMENT select (when+,otherwise?)&gt;
    &lt;!ATTLIST select type CDATA #REQUIRED&gt;
    &lt;!ATTLIST select method (exclusive|inclusive) #IMPLIED "exclusive"&gt;
    &lt;!ELEMENT when (generate*,transform*,serialize?)&gt;
    &lt;!ATTLIST when test CDATA #REQUIRED&gt;
    &lt;!ELEMENT otherwise (generate*,transform*,serialize?)&gt;
  </pre><div id="class-selector-method-__init__" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">__init__(self, parent, method="exclusive", root_path="")</div><table style="margin-left:15px"><tr><td style="font-weight:bold">overrides</td><td style="background-color:#FFF0D8"><a href="#class-syntax_component-method-__init__">syntax_component.__init__</a></td></tr></table><div style="margin-left:15px">
      <p>
	Calls <a href="#class-syntax_component-method-__init__">syntax_component.__init__</a> and
	sets <a href="#class-selector-property-description">description</a> property to "Selector
	bass class". <span style="font-style:italic">method</span> defines how child <a href="#class-when">when</a> components will be treated: "exclusive" means that once a matching
	<span style="font-style:italic">when</span> has been found, the selector will stop and return its result;
	"inclusive" means that every child <span style="font-style:italic">when</span> component will be
	tested and each one that matches will apply.
      </p>
    </div></div><div id="class-selector-method-when_func" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">when_func(self, req, conditions)</div><table style="margin-left:15px"><tr><td style="font-weight:bold">returns</td><td style="background-color:#FFF0D8">
      Returns a boolean.
    </td></tr></table><div style="margin-left:15px">
      <p>
	Used to implement the selector's logic. <span style="font-style:italic">req</span> is an Apache request
	object; <span style="font-style:italic">conditions</span> is a list of strings which are given in the
	<span style="font-style:italic">test</span> attribute of a child <a href="#class-when">when</a> element.
      </p>
      <p>
	The default behaviour of this method is to raise the <span style="font-style:italic">NoImplemented</span>
	exception. Derived components should return <span style="font-style:italic">True</span> if the condition
	matches, or <span style="font-style:italic">False</span> otherwise.
      </p>
    </div></div><div id="class-selector-method-_result" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">_result(self, req, p_sibling_result=None, child_results=[])</div><table style="margin-left:15px"><tr><td style="font-weight:bold">overrides</td><td style="background-color:#FFF0D8"><a href="#class-component-method-_result">component._result</a></td></tr><tr><td style="font-weight:bold">returns</td><td style="background-color:#FFF0D8">
      Returns a tuple whose first member is a boolean flag indicating whether the execution was
      successful or not and whose second member is the <span style="font-style:italic">Element</span> result.
    </td></tr></table><div style="margin-left:15px">
      <p>
	If the component's <a href="#class-selector-property-method">method</a> property is
	"exclusive", the method either returns the last <span style="font-style:italic">child_results</span>
	element (if its not None) or the <span style="font-style:italic">p_sibling_result</span>.
      </p>
      <p>
	If the <a href="#class-selector-property-method">method</a> property is "inclusive" and
	the <span style="font-style:italic">child_results</span> list it not empty, each
	<span style="font-style:italic">child_results</span> element is aggregated into a parent element called
	"inclusive-select". If the <span style="font-style:italic">child_results</span> list is empty then the
	<span style="font-style:italic">p_sibling_result</span> is returned instead.
      </p>
    </div></div><div id="class-selector-property-method" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">method</div>
    <div style="margin-left:15px">
      Takes either the value "exclusive" (the default) or "inclusive"; "exclusive" means that once a
      matching <span style="font-style:italic">when</span> has been found, the selector will stop and return its
      result; "inclusive" means that every child <span style="font-style:italic">when</span> component
      will be tested and each one that matches will apply.
    </div>
  </div></div>

<div class="class" id="class-stream_component" style="border-top:1px solid #000000;border-bottom:1px solid #000000;margin-top:5px"><div style="font-size:120%;font-style:italic;margin-top:10px;margin-bottom:10px">stream_component</div><table><tr><td style="font-weight:bold">inherits</td><td style="background-color:#FFF0D8"><a href="#class-component">component</a></td></tr><tr><td style="font-weight:bold">source</td><td style="font-family:monospace;background-color:#FFF0D8">pycoon/components.py</td></tr></table><p>
    Base class for all components which handle XML data in a pipeline.
  </p><div id="class-stream_component-method-__init__" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">__init__(self, parent, root_path="")</div><table style="margin-left:15px"><tr><td style="font-weight:bold">overrides</td><td style="background-color:#FFF0D8"><a href="#class-component-method-__init__">component.__init__</a></td></tr></table><div style="margin-left:15px">
      <p>
	Calls <a href="#class-component-method-__init__">component.__init__</a> and sets <a href="#class-stream_component-property-description">description</a> property to "Streamed
	component base class".
      </p>
    </div></div><div id="class-stream_component-class_property-role" style="margin-bottom:5px;background-color:#FFEBE6">
    <div style="font-weight:bold">role</div><div style="margin-left:15px;margin-top:5px;font-style:italic">class property</div>
    <div style="margin-left:15px">
      For stream_component class the value is "stream".
    </div>
  </div></div>

<div class="class" id="class-pipeline" style="border-top:1px solid #000000;border-bottom:1px solid #000000;margin-top:5px"><div style="font-size:120%;font-style:italic;margin-top:10px;margin-bottom:10px">pipeline</div><table><tr><td style="font-weight:bold">inherits</td><td style="background-color:#FFF0D8"><a href="#class-component">component</a></td></tr><tr><td style="font-weight:bold">source</td><td style="font-family:monospace;background-color:#FFF0D8">pycoon/pipeline.py</td></tr></table><p>
    The container class for components which provides 'execution' methods for pipeline processing.
  </p><div style="font-weight:bold">syntax</div><pre>
    &lt;!ELEMENT pipeline (match+)&gt;
  </pre><div id="class-pipeline-method-__init__" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">__init__(self, parent, cache_as="")</div><table style="margin-left:15px"><tr><td style="font-weight:bold">overrides</td><td style="background-color:#FFF0D8"><a href="#class-component-method-__init__">component.__init__</a></td></tr></table><div style="margin-left:15px">
      <p>
	Class constructor. <span style="font-style:italic">cache_as</span> is currently not used.
      </p>
      <p>
	The method just calls <a href="#class-component-method-__init__">component.__init__</a>
	and sets its <span style="font-style:italic">description</span> property to "Pipeline".
      </p>
    </div></div><div id="class-pipeline-method-force_execute" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">force_execute(self, output, uri)</div><table style="margin-left:15px"><tr><td style="font-weight:bold">returns</td><td style="background-color:#FFF0D8">
      Returns a 3-tuple which consists of: a boolean flag indicating whether the execution was
      successful or not; the result of the execution which is either a character stream or an HTTP
      error code; the MIME type of the result.
    </td></tr></table><div style="margin-left:15px">
      <p>
	Allows a pipeline to be executed without an Apache request object and without returning the
	result to the client. <span style="font-style:italic">output</span> is a file-like object and
	<span style="font-style:italic">uri</span> is a request URI string.
      </p>
      <p>
	This method creates a fake request object using the give file-like object and URI string and
	then calls the <a href="#class-pipeline-method-execute">execute</a> using this object
	(rather than a real Apache request object). The result of the execution will be written to
	the given file-like object and not returned to the client.  It is used by the <a href="#class-interpolate_context-method-__call__">context</a> interpolation method.
      </p>
    </div></div><div id="class-pipeline-method-_descend" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">_descend(self, req, p_sibling_result=None)</div><table style="margin-left:15px"><tr><td style="font-weight:bold">overrides</td><td style="background-color:#FFF0D8"><a href="#class-component-method-_descend">component._descend</a></td></tr><tr><td style="font-weight:bold">returns</td><td style="background-color:#FFF0D8">
      Returns a boolean.
    </td></tr></table><div style="margin-left:15px">
      <p>
	Returns True so that child components of the pipeline will be executed.
      </p>
    </div></div><div id="class-pipeline-method-_result" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">_result(self, req, p_sibling_result=None, child_results=[])</div><table style="margin-left:15px"><tr><td style="font-weight:bold">overrides</td><td style="background-color:#FFF0D8"><a href="#class-component-method-_result">component._result</a></td></tr><tr><td style="font-weight:bold">returns</td><td style="background-color:#FFF0D8">
      Returns a tuple whose first member is a boolean flag indicating whether the execution was
      successful or not and whose second member is the <span style="font-style:italic">Element</span> result.
    </td></tr></table><div style="margin-left:15px">
      <p>
	This default implementation for pipelines simply either returns the last
	<span style="font-style:italic">child_results</span> <span style="font-style:italic">Element</span> (if there is one) or
	None.
      </p>
    </div></div><div id="class-pipeline-method-execute" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">execute(self, req)</div><table style="margin-left:15px"><tr><td style="font-weight:bold">returns</td><td style="background-color:#FFF0D8">
      Returns a 3-tuple which consists of: a boolean flag indicating whether the execution was
      successful or not; the result of the execution which is either a character stream or an HTTP
      error code; the MIME type of the result.
    </td></tr></table><div style="margin-left:15px">
      <p>
	Executes the pipeline. <span style="font-style:italic">req</span> is an Apache request object.
      </p>
      <p>
	This method calls the object's inherited <a href="#class-component-method-__call__">__call__</a> method, extracts the success flag, result stream and MIME
	type from the return value and returns all three as a tuple. It catches any exceptions
	raised during the execution, stores the traceback in a global location and returns a False
	success flag and an HTTP 500 error.
      </p>
    </div></div><div id="class-pipeline-method-handle_error" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">handle_error(self, req)</div><table style="margin-left:15px"><tr><td style="font-weight:bold">returns</td><td style="background-color:#FFF0D8">
      Returns a 3-tuple which consists of: a boolean flag indicating whether the execution was
      successful or not; the result of the execution which is either a character stream or an HTTP
      error code; the MIME type of the result.
    </td></tr></table><div style="margin-left:15px">
      <p>
	Executes the pipeline but only using its <a href="#class-error_matcher">error_matcher</a>
	components. <span style="font-style:italic">req</span> is an Apache request object whose
	<span style="font-style:italic">status</span> property should contain the HTTP error code being handled.
      </p>
      <p>
	This method uses the <a href="#class-component-method-find_components">component.find_components</a> method to search for all <a href="#class-error_matcher">error_matcher</a> components. It executes the first one which can
	handle the error code in the given Request object's <span style="font-style:italic">status</span>
	property.  When an error_matcher is executed, it will return a tuple whose first member is a
	'success' flag which is True if the execution was successful (and therefore the error has
	been handled) or False otherwise. If the method either could not find a suitable
	error_matcher or if an error_matcher returned False, it will return False and the error will
	not have been handled (further error handling in the sitemap or server will then apply).
      </p>
    </div></div><div id="class-pipeline-class_property-role" style="margin-bottom:5px;background-color:#FFEBE6">
    <div style="font-weight:bold">role</div><div style="margin-left:15px;margin-top:5px;font-style:italic">class property</div>
    <div style="margin-left:15px">
      Value is "pipeline".
    </div>
  </div><div id="class-pipeline-class_property-function" style="margin-bottom:5px;background-color:#FFEBE6">
    <div style="font-weight:bold">function</div><div style="margin-left:15px;margin-top:5px;font-style:italic">class property</div>
    <div style="margin-left:15px">
      Value is "pipeline".
    </div>
  </div>
  <div id="class-pipeline-helper_func-register_invokation_syntax" style="margin-bottom:5px;background-color:#E0DEFF">
    <div style="font-weight:bold">register_invokation_syntax(server)</div><div style="margin-left:15px;margin-top:5px;font-style:italic">helper function</div>
    <div style="margin-left:15px">
      <p>
	This function creates and populates an instance of the <a href="#class-invokation_syntax">invokation_syntax</a> class with the syntax for pipeline
	elements. This instance is then stored in the given server object's <a href="#class-server_config-property-component_syntaxes">component_syntaxes</a> dictionary.
      </p>
    </div>
  </div><div id="class-pipeline-helper_func-build_pipeline" style="margin-bottom:5px;background-color:#E0DEFF">
    <div style="font-weight:bold">build_pipeline(server, sitemap, attrs, **kw_args)</div><div style="margin-left:15px;margin-top:5px;font-style:italic">helper function</div>
    <div style="margin-left:15px"><span style="font-weight:bold">returns</span><span>
      A pipeline object.
    </span></div>
    <div style="margin-left:15px">
      <p>
	This function creates a new pipeline object from the given
	<span style="font-style:italic">xml.sax.xmlreader.AttributesImpl</span> object (in fact, at present
	pipeline elements use no attributes). If the pipeline is a sitemap pipeline (the ordinary
	case) the parent <span style="font-style:italic">server</span> and <span style="font-style:italic">sitemap</span>
	objects should be specified and the new pipeline will be added to the sitemap's <a href="#class-sitemap_config-property-pipelines">pipelines</a> list. If the given
	<span style="font-style:italic">sitemap</span> is None, then the new pipeline is added to the server's
	<a href="#class-server_config-property-pipelines">pipelines</a> list.
      </p>
      <p>
	The new pipeline object is returned.
      </p>
    </div>
  </div></div>

<div class="class" id="class-generator" style="border-top:1px solid #000000;border-bottom:1px solid #000000;margin-top:5px"><div style="font-size:120%;font-style:italic;margin-top:10px;margin-bottom:10px">generator</div><table><tr><td style="font-weight:bold">inherits</td><td style="background-color:#FFF0D8"><a href="#class-stream_component">stream_component</a></td></tr><tr><td style="font-weight:bold">source</td><td style="font-family:monospace;background-color:#FFF0D8">pycoon/generators/__init__.py</td></tr></table><p>
    Base class for all generator components.
  </p><div style="font-weight:bold">syntax</div><pre>
    &lt;!ELEMENT match (generate?,...)&gt;
    &lt;!ELEMENT when (generate?,...)&gt;
    &lt;!ELEMENT otherwise (generate?,...)&gt;
    &lt;!ELEMENT aggregate (generate+)&gt;
    &lt;!ELEMENT generate (parameter*)&gt;
    &lt;!ATTLIST generate type CDATA #REQUIRED&gt;
  </pre><div id="class-generator-method-__init__" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">__init__(self, parent, root_path="")</div><table style="margin-left:15px"><tr><td style="font-weight:bold">overrides</td><td style="background-color:#FFF0D8"><a href="#class-stream_component-method-__init__">stream_component.__init__</a></td></tr></table><div style="margin-left:15px">
      <p>
	Just calls stream_component's <a href="#class-stream_component-method-__init__">__init__</a> method and sets <span style="font-style:italic">description</span>
	property to "Generator base class".
      </p>
    </div></div><div id="class-generator-class_property-role" style="margin-bottom:5px;background-color:#FFEBE6">
    <div style="font-weight:bold">role</div><div style="margin-left:15px;margin-top:5px;font-style:italic">class property</div>
    <div style="margin-left:15px">
      Value is "stream".
    </div>
  </div><div id="class-generator-class_property-function" style="margin-bottom:5px;background-color:#FFEBE6">
    <div style="font-weight:bold">function</div><div style="margin-left:15px;margin-top:5px;font-style:italic">class property</div>
    <div style="margin-left:15px">
      Value is "generate".
    </div>
  </div><div id="class-generator-helper_func-register_invokation_syntax" style="margin-bottom:5px;background-color:#E0DEFF">
    <div style="font-weight:bold">register_invokation_syntax(server)</div><div style="margin-left:15px;margin-top:5px;font-style:italic">helper function</div>
    <div style="margin-left:15px">
      <p>
	This function creates and populates an instance of the <a href="#class-invokation_syntax">invokation_syntax</a> class with an abstract syntax for
	generator elements. This instance is then stored in the given server object's <a href="#class-server_config-property-component_syntaxes">component_syntaxes</a> dictionary.
      </p>
    </div>
  </div><div id="class-generator-helper_func-init_datasource" style="margin-bottom:5px;background-color:#E0DEFF">
    <div style="font-weight:bold">init_datasource[_*](sitemap, attrs)</div><div style="margin-left:15px;margin-top:5px;font-style:italic">helper function</div>
    <div style="margin-left:15px">
      <p>
	Generator modules may provide init_datasource functions if they need to connect to a
	database.  The function names should either be just "init_datasource" or, if multiple
	database servers could be used (e.g. SQL generator could use MySQL, Postgres, etc.), then
	multiple functions should be defined and the function name should have the database name
	appended to the end, e.g. "init_datasource_mysql".  The appended portion of the name
	(e.g. "mysql") must then be provided as the value of the "backend" attribute in the server
	configuration XML file where the generator is defined.
      </p>
      <p>
	The method will usually return a cursor-like object providing a connection to the database.
	[It is important for component developers to note that the corresponding generator's <a href="#class-generator-method-_result">_result</a> method will probably expect a uniform
	interface to databases to be returned by this function, otherwise it will have to provide
	different code for every type of database available. If it is not possible to provide a
	uniform interface to multiple databases, then a better solution may be to provide multiple
	generators instead - one for each type of database.]
      </p>
    </div>
  </div></div>

<div class="class" id="class-transformer" style="border-top:1px solid #000000;border-bottom:1px solid #000000;margin-top:5px"><div style="font-size:120%;font-style:italic;margin-top:10px;margin-bottom:10px">transformer</div><table><tr><td style="font-weight:bold">inherits</td><td style="background-color:#FFF0D8"><a href="#class-stream_component">stream_component</a></td></tr><tr><td style="font-weight:bold">source</td><td style="font-family:monospace;background-color:#FFF0D8">pycoon/transformers/__init__.py</td></tr></table><p>
    Base class for all transformer components.
  </p><div style="font-weight:bold">syntax</div><pre>
    &lt;!ELEMENT match (transform?,...)&gt;
    &lt;!ELEMENT when (transform?,...)&gt;
    &lt;!ELEMENT otherwise (transform?,...)&gt;
    &lt;!ELEMENT transform (parameter*)&gt;
    &lt;!ATTLIST transform type CDATA #REQUIRED&gt;
  </pre><div id="class-transformer-method-__init__" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">__init__(self, parent, root_path="")</div><table style="margin-left:15px"><tr><td style="font-weight:bold">overrides</td><td style="background-color:#FFF0D8"><a href="#class-stream_component-method-__init__">stream_component.__init__</a></td></tr></table><div style="margin-left:15px">
      <p>
	Just calls stream_component's <a href="#class-stream_component-method-__init__">__init__</a> method and sets <span style="font-style:italic">description</span>
	property to "Transformer base class".
      </p>
    </div></div><div id="class-transformer-class_property-role" style="margin-bottom:5px;background-color:#FFEBE6">
    <div style="font-weight:bold">role</div><div style="margin-left:15px;margin-top:5px;font-style:italic">class property</div>
    <div style="margin-left:15px">
      Value is "stream".
    </div>
  </div><div id="class-transformer-class_property-function" style="margin-bottom:5px;background-color:#FFEBE6">
    <div style="font-weight:bold">function</div><div style="margin-left:15px;margin-top:5px;font-style:italic">class property</div>
    <div style="margin-left:15px">
      Value is "transform".
    </div>
  </div><div id="class-transformer-helper_func-register_invokation_syntax" style="margin-bottom:5px;background-color:#E0DEFF">
    <div style="font-weight:bold">register_invokation_syntax(server)</div><div style="margin-left:15px;margin-top:5px;font-style:italic">helper function</div>
    <div style="margin-left:15px">
      <p>
	This function creates and populates an instance of the <a href="#class-invokation_syntax">invokation_syntax</a> class with an abstract syntax for
	transformer elements. This instance is then stored in the given server object's <a href="#class-server_config-property-component_syntaxes">component_syntaxes</a> dictionary.
      </p>
    </div>
  </div></div>

<div class="class" id="class-serializer" style="border-top:1px solid #000000;border-bottom:1px solid #000000;margin-top:5px"><div style="font-size:120%;font-style:italic;margin-top:10px;margin-bottom:10px">serializer</div><table><tr><td style="font-weight:bold">inherits</td><td style="background-color:#FFF0D8"><a href="#class-stream_component">stream_component</a></td></tr><tr><td style="font-weight:bold">source</td><td style="font-family:monospace;background-color:#FFF0D8">pycoon/serializers/__init__.py</td></tr></table><p>
    Base class for all serializer components.
  </p><div style="font-weight:bold">syntax</div><pre>
    &lt;!ELEMENT match (serialize?,...)&gt;
    &lt;!ELEMENT when (serialize?,...)&gt;
    &lt;!ELEMENT otherwise (serialize?,...)&gt;
    &lt;!ELEMENT serialize&gt;
    &lt;!ATTLIST serialize type CDATA #REQUIRED&gt;
    &lt;!ATTLIST serialize mime CDATA #IMPLIED&gt;
  </pre><div id="class-serializer-method-__init__" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">__init__(self, parent, root_path="")</div><table style="margin-left:15px"><tr><td style="font-weight:bold">overrides</td><td style="background-color:#FFF0D8"><a href="#class-stream_component-method-__init__">stream_component.__init__</a></td></tr></table><div style="margin-left:15px">
      <p>
	Just calls stream_component's <a href="#class-stream_component-method-__init__">__init__</a> method and sets <span style="font-style:italic">description</span>
	property to "Serializer base class".
      </p>
    </div></div><div id="class-serializer-class_property-role" style="margin-bottom:5px;background-color:#FFEBE6">
    <div style="font-weight:bold">role</div><div style="margin-left:15px;margin-top:5px;font-style:italic">class property</div>
    <div style="margin-left:15px">
      Value is "stream".
    </div>
  </div><div id="class-serializer-class_property-function" style="margin-bottom:5px;background-color:#FFEBE6">
    <div style="font-weight:bold">function</div><div style="margin-left:15px;margin-top:5px;font-style:italic">class property</div>
    <div style="margin-left:15px">
      Value is "serialize".
    </div>
  </div><div id="class-serializer-helper_func-register_invokation_syntax" style="margin-bottom:5px;background-color:#E0DEFF">
    <div style="font-weight:bold">register_invokation_syntax(server)</div><div style="margin-left:15px;margin-top:5px;font-style:italic">helper function</div>
    <div style="margin-left:15px">
      <p>
	This function creates and populates an instance of the <a href="#class-invokation_syntax">invokation_syntax</a> class with an abstract syntax for
	serializer elements. This instance is then stored in the given server object's <a href="#class-server_config-property-component_syntaxes">component_syntaxes</a> dictionary.
      </p>
    </div>
  </div></div>

<div class="class" id="class-server_config" style="border-top:1px solid #000000;border-bottom:1px solid #000000;margin-top:5px"><div style="font-size:120%;font-style:italic;margin-top:10px;margin-bottom:10px">server_config</div><table><tr><td style="font-weight:bold">source</td><td style="font-family:monospace;background-color:#FFF0D8">pycoon/server.py</td></tr></table><p>
    Holds the configuration information of a running Pycoon instance including available component
    classes for building pipelines, data source initialisation methods and the default error
    handling pipelines. It persists between requests by being created as a global object in the
    handler module.
  </p><div id="class-server_config-method-__init__" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">__init__(self)</div><div style="margin-left:15px">
      <p>
	Class constructor. Creates all the object properties and populates them with default or
	empty values. Also registers the built in <a href="#class-interpolation_syntax">interpolation_syntax</a> objects.
      </p>
    </div></div><div id="class-server_config-method-get_new_component" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">get_new_component(self, el_name, parent, attrs, root_path)</div><table style="margin-left:15px"><tr><td style="font-weight:bold">returns</td><td style="background-color:#FFF0D8">
      a new component object.
    </td></tr></table><div style="margin-left:15px">
      <p>
	Creates a new component object from the given parameters. <span style="font-style:italic">el_name</span>
	is the element name given in a sitemap file to declare the component;
	<span style="font-style:italic">parent</span> is the element name of the parent element in the sitemap
	file; <span style="font-style:italic">attrs</span> is an <span style="font-style:italic">xml.sax.Attributes</span>
	instance which contains the attributes given in the sitemap file to declare the component;
	<span style="font-style:italic">root_path</span> is either the sitemap or server document root depending
	on whether the component is part of a sitemap pipeline (the ordinary case) or a server
	pipeline.
      </p>
      <p>
	This method attempts to find a component class in the <a href="#class-server_config-property-components">components</a> dictionary which matches the given element name. If
	one matches and the given <span style="font-style:italic">attrs</span> provide a valid declaration, then a
	new instance of the component class is created with the given parameters and returned.
      </p>
    </div></div><div id="class-server_config-method-handler_error" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">handle_error(self, req, error_code)</div><table style="margin-left:15px"><tr><td style="font-weight:bold">returns</td><td style="background-color:#FFF0D8">
      a 2-tuple whose first memeber is a boolean flag which is True if the error was successfully
      handled or False otherwise and whose second memeber is <span style="font-style:italic">apache.DONE</span>.
    </td></tr></table><div style="margin-left:15px">
      <p>
	Attempts to handle an HTTP error condition. <span style="font-style:italic">req</span> is an Apache
	request object; <span style="font-style:italic">error_code</span> is an HTTP error code.
      </p>
      <p>
	This method loops through the server's <a href="#class-server_config-property-pipelines">pipelines</a> and calls each one's <a href="#class-pipeline-method-handle_error">handle_error</a> method until one of them successfully handles the
	error. If none of the pipelines handles the error then it is simply left unhandled by
	returning the error code to the client but with no error page.
      </p>
    </div></div><div id="class-server_config-property-log_up_down" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">log_up_down</div>
    <div style="margin-left:15px">
      A boolean value which is True if logging of the server startup and shutdown has been enabled.
    </div>
  </div><div id="class-server_config-property-log_errors" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">log_errors</div>
    <div style="margin-left:15px">
      A boolean value which is True if logging of error handling has been enabled.
    </div>
  </div><div id="class-server_config-property-log_requests" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">log_requests</div>
    <div style="margin-left:15px">
      A boolean value which is True if logging of request handling has been enabled.
    </div>
  </div><div id="class-server_config-property-log_debug" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">log_debug</div>
    <div style="margin-left:15px">
      A boolean value which is True if logging of debugging information has been enabled.
    </div>
  </div><div id="class-server_config-property-EXCEPTION" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">EXCEPTION</div>
    <div style="margin-left:15px">
      Holds the exception information and traceback when an exception occured during pipeline
      processing.
    </div>
  </div><div id="class-server_config-property-component_super_types" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">component_super_types</div>
    <div style="margin-left:15px">
      A list of the allowed container element names for declaring available components in the server
      configuration file: ["built-in", "matchers", "selectors", "authenticators", "generators",
      "transformers", "serializers"].
    </div>
  </div><div id="class-server_config-property-component_types" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">component_types</div>
    <div style="margin-left:15px">
      A list of the allowed element names for declaring available components in the server
      configuration file: ["component", "matcher", "selector", "generator", "transformer",
      "serializer"]
    </div>
  </div><div id="class-server_config-property-components" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">components</div>
    <div style="margin-left:15px">
      A dictionary of available component classes; indexed using the 2-tuple: (function
      [generate|transform|...], required value of 'type' attribute).
    </div>
  </div><div id="class-server_config-property-component_enames" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">component_enames</div>
    <div style="margin-left:15px">
      A list of the available components' element names.
    </div>
  </div><div id="class-server_config-property-component_syntaxes" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">component_syntaxes</div>
    <div style="margin-left:15px">
      A dictionary of <a href="#class-invokation_syntax">invokation_syntax</a> objects for the
      available components; indexed using the 2-tuple: (function [generate|transform|...], required
      value of 'type' attribute).
    </div>
  </div><div id="class-server_config-property-interpolation_syntaxes" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">interpolation_syntaxes</div>
    <div style="margin-left:15px">
      A dictionary of <a href="#class-interpolation_syntax">interpolation_syntax</a> objects;
      indexed by name.
    </div>
  </div><div id="class-server_config-property-ds_initialisers" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">ds_initialisers</div>
    <div style="margin-left:15px">
      A dictionary of <a href="#class-generator-helper_func-init_datasource">init_datasource</a>
      methods which have been extracted from all the generator modules which provide them by the
      <a href="#class-component-helper_func-register_component">register_component</a> function.
    </div>
  </div><div id="class-server_config-property-pipelines" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">pipelines</div>
    <div style="margin-left:15px">
      A list of <a href="#class-pipeline">pipeline</a> objects; these are where the server defines
      its default error handlers.
    </div>
  </div><div id="class-server_config-property-access_log" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">access_log</div>
    <div style="margin-left:15px">
      A file-like object which allows writing to the Apache access log. NOT IMPLEMENTED.
    </div>
  </div><div id="class-server_config-property-error_log" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">error_log</div>
    <div style="margin-left:15px">
      A file-like object which allows writing to the Apache error log.
    </div>
  </div><div id="class-server_config-property-config_root" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">config_root</div>
    <div style="margin-left:15px">
      The absolute path specified in the Apache VirtualHost directive as the PycoonConfigRoot.
    </div>
  </div><div id="class-server_config-property-document_root" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">document_root</div>
    <div style="margin-left:15px">
      This property mirros the <a href="#class-server_config-property-config_root">config_root</a>
      and allows a certain amount of polymorphism between sevrer_config and sitemap_config objects.
    </div>
  </div></div>

<div class="class" id="class-sitemap_config" style="border-top:1px solid #000000;border-bottom:1px solid #000000;margin-top:5px"><div style="font-size:120%;font-style:italic;margin-top:10px;margin-bottom:10px">sitemap_config</div><table><tr><td style="font-weight:bold">source</td><td style="font-family:monospace;background-color:#FFF0D8">pycoon/sitemap.py</td></tr></table><p>
    The sitemap class holds configuration information for a Pycoon sitemap along with the <a href="#class-pipeline">pipeline</a> objects, any related database connections and provides the
    primary interface for handling requests.
  </p><div style="font-weight:bold">syntax</div><pre>
    &lt;!ELEMENT site-map (components?, pipelines)&gt;
    &lt;!ATTLIST site-map document-root CDATA #REQUIRED&gt;
    &lt;!ELEMENT components (data-source*)&gt;
    &lt;!ELEMENT data-source EMPTY&gt;
    &lt;!ATTLIST data-source type CDATA #REQUIRED&gt;
    &lt;!ATTLIST data-source name CDATA #REQUIRED&gt;
    &lt;!ATTLIST data-source src CDATA #REQUIRED&gt;
    &lt;!ELEMENT pipelines (pipeline+)&gt;
    &lt;!ELEMENT pipeline (match+)&gt;
    ...
  </pre><div id="class-sitemap_config-method-__init__" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">__init__(self, parent)</div><div style="margin-left:15px">
      <p>
	Class constructor. Creates all the object properties and populates them with default or
	empty values.
      </p>
    </div></div><div id="class-sitemap_config-method-handle" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">handle(self, req)</div><table style="margin-left:15px"><tr><td style="font-weight:bold">returns</td><td style="background-color:#FFF0D8">
      Returns a 2-tuple which consists of: a boolean flag indicating whether the request was
      successfully handled or not; and an apache error/status code.
    </td></tr></table><div style="margin-left:15px">
      <p>
	Attempts to handle the given request. <span style="font-style:italic">req</span> is an Apache request
	object.
      </p>
      <p>
	This method loops over the available <a href="#class-sitemap_config-property-pipelines">pipelines</a> and calls each one's <a href="#class-pipeline-method-execute">execute</a> method. If the method returns True, the returned result it
	written to the client. If it returns True, but the returned result is empty, it means that
	the pipeline did not match; in this case the next pipeline is tried. If it returns False, it
	means there was an error processing the pipeline and the <a href="#class-sitemap_config-method-handle_error">handle_error</a> method is called. If the loop terminates without a
	matching pipeline having been found, the <a href="#class-sitemap_config-method-handle_error">handle_error</a> method is called with an
	<span style="font-style:italic">apache.HTTP_NOT_FOUND</span> status.
      </p>
    </div></div><div id="class-sitemap_config-method-handle_error" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">handle_error(self, req, error_code)</div><table style="margin-left:15px"><tr><td style="font-weight:bold">returns</td><td style="background-color:#FFF0D8">
      Returns a 2-tuple which consists of: a boolean flag indicating whether the error was
      successfully handled or not; and an apache error/status code which should be
      <span style="font-style:italic">apache.DONE</span> if the error was handled, or the given
      <span style="font-style:italic">error_code</span> if not.
    </td></tr></table><div style="margin-left:15px">
      <p>
	Attempts to handle an HTTP error. <span style="font-style:italic">req</span> is an Apache request object;
	<span style="font-style:italic">error_code</span> is an HTTP error code.
      </p>
      <p>
	This method loops over the available <a href="#class-sitemap_config-property-pipelines">pipelines</a> and calls each one's <a href="#class-pipeline-method-handle_error">handle_error</a> method. If the error handler returns True, the
	returned result is written to the client and the method returns the tuple
	(<span style="font-style:italic">True</span>, <span style="font-style:italic">apache.DONE</span>). If the loop
	terminates without a matching error handler having been found, the method returns False,
	along with the given <span style="font-style:italic">error_code</span>.
      </p>
    </div></div><div id="class-sitemap_config-property-parent" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">parent</div>
    <div style="margin-left:15px">
      The sitemap object's parent <a href="#class-server_config">server_config</a> (this name allows
      simple polypmorphism between sitemap and server objects)
    </div>
  </div><div id="class-sitemap_config-property-server" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">server</div>
    <div style="margin-left:15px">
      The sitemap object's parent <a href="#class-server_config">server_config</a>
    </div>
  </div><div id="class-sitemap_config-property-server_name" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">server_name</div>
    <div style="margin-left:15px">
      The name of the VirtualHost on which the handler is running
    </div>
  </div><div id="class-sitemap_config-property-document_root" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">document_root</div>
    <div style="margin-left:15px">
      The absolute path which is used by default by all the sitemap components when retrieving local
      resources; it is set with the site-map element's <span style="font-style:italic">document-root</span>
      attribute
    </div>
  </div><div id="class-sitemap_config-property-data_sources" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">data_sources</div>
    <div style="margin-left:15px">
      A dictionary of database connection objects; indexed by database name. This dictionary is
      populated using the <a href="#class-generator-helper_func-init_datasource">init_datasource_*(sitemap, attrs)</a> functions provided by
      generator modules which require database connections. These functions are called by the <a href="#class-component-helper_func-register_component">register_component</a> function and the
      selection of which function to call is made using the <span style="font-style:italic">backend</span>
      attribute of the generator's declaration in the server.xml configuration file. The class of
      connection objects themsevles depends on the database being connected to. Ideally, where a
      generator has one than one backend, the connection object interfaces should be compatible
      (e.g. DBI).
    </div>
  </div><div id="class-sitemap_config-property-ds_mods" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">ds_mods</div>
    <div style="margin-left:15px">
      A dictionary of modules or classes needed to establish database connections. This dictionary
      is populated using the <a href="#class-component-helper_func-register_component">register_component</a> and indexed by module name.
    </div>
  </div><div id="class-sitemap_config-property-pipelines" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">pipelines</div>
    <div style="margin-left:15px">
      A list of <a href="#class-pipeline">pipeline</a> objects.
    </div>
  </div></div>

<div class="class" id="class-sitemap_config_parse" style="border-top:1px solid #000000;border-bottom:1px solid #000000;margin-top:5px"><div style="font-size:120%;font-style:italic;margin-top:10px;margin-bottom:10px">sitemap_config_parse</div><table><tr><td style="font-weight:bold">inherits</td><td style="background-color:#FFF0D8"><a href="#class-xml.sax.handler.ContentHandler">xml.sax.handler.ContentHandler</a></td></tr><tr><td style="font-weight:bold">source</td><td style="font-family:monospace;background-color:#FFF0D8">pycoon/sitemap.py</td></tr></table><p>
    The sitemap_config_parse class is a SAX handler which parses sitemap XML configuration files in
    order to populate <a href="#class-sitemap_config">sitemap_config</a> objects.
  </p><div id="class-sitemap_config_parse-method-__init__" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">__init__(self, filename, sitemap)</div><div style="margin-left:15px">
      <p>
	Class constructor. <span style="font-style:italic">filename</span> is the file URL of the sitemap XML
	file. <span style="font-style:italic">sitemap</span> is a <a href="#class-sitemap_config">sitemap_config</a> instance which will be populated with the
	configuration from the sitemap file.
      </p>
      <p>
	This constructor method begins parsing the configuration file immediately, meaning that the
	class is used more like a function.
      </p>
    </div></div><div id="class-sitemap_config_parse-method-startElement" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">startElement(self, name, attrs)</div><table style="margin-left:15px"><tr><td style="font-weight:bold">overrides</td><td style="background-color:#FFF0D8">xml.sax.handler.ContentHandler.startElement</td></tr></table><div style="margin-left:15px">
      <p>
	Handles start element events in parsing the XML file. <span style="font-style:italic">name</span> is the
	element's name and <span style="font-style:italic">attrs</span> is the element's attribute values.
      </p>
      <p>
	This is the main method of the class. It consists of a series of if/elif blocks which make
	the method's behaviour conditional on the name of the element being processed.
      </p>
      <ul>
	<li>
	  element name "site-map": retrieve the document-root attribute from the element and assign
	  it to the sitemap's <a href="#class-sitemap_config-property-document_root">document_root</a>.
	</li>
	<li>
	  element name "components": set the <a href="#class-sitemap_config_parse-property-in_components">in_components</a> flag to True
	</li>
	<li>
	  element name "data-source": if the <a href="#class-sitemap_config_parse-property-in_components">in_components</a> flag is True (i.e. if the
	  &lt;data-source&gt; element is inside the &lt;components&gt; element) and the current
	  server has a <a href="#class-server_config-property-ds_initialisers">datasource initialiser
	  method</a> for the data source type sepcified in the element's "type" attribute then
	  that initialiser method is called with the current element's attributes as arguments.
	</li>
	<li>
	  element name "pipelines": set the <a href="#class-sitemap_config_parse-property-in_pipelines">in_pipelines</a> flag to True.
	</li>
	<li>
	  element name "pipeline": if the <a href="#class-sitemap_config_parse-property-in_pipelines">in_pipelines</a> flag is True (i.e. if the &lt;pipeline&gt;
	  element is inside the &lt;pipelines&gt; element) then use <a href="#class-pipeline-helper_func-build_pipeline">pipeline.build_pipeline</a> to create a new pipeline
	  object using the current element's attribute values as arguments.  The new pipeline object
	  is assigned to the <a href="#class-sitemap_config_parse-property-proc_comp_stack">proc_comp_stack</a> as the first object in the list.
	</li>
	<li>
	  if the element name is in the current server's <a href="#class-server_config-property-component_enames">component_enames</a> list, then it is the definition of a
	  sitemap component. The method attempts to create a new component using the element's tag
	  name and attributes as arguments to the current server's <a href="#class-server_config-method-get_new_component">get_new_component</a> method. If it was successfull, the new
	  component is passed as an argument to the <a href="#class-component-method-add_component">add_component</a> method of the last component in the <a href="#class-sitemap_config_parse-property-proc_comp_stack">proc_comp_stack</a> and then
	  appended to this list itself.
	</li>
      </ul>
      <p>
	If the element name has not been handled by any of these conditions then an exception is
	raised saying the the element name is unrecognised.
      </p>
    </div></div><div id="class-sitemap_config_parse-method-endElement" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">endElement(self, name)</div><table style="margin-left:15px"><tr><td style="font-weight:bold">overrides</td><td style="background-color:#FFF0D8">xml.sax.handler.ContentHandler.endElement</td></tr></table><div style="margin-left:15px">
      <p>
	This method handles the SAX event when an element is closed. It consists of a few if/elif
	blocks:
      </p>
      <ul>
	<li>
	  element name "pipeline": if the logging level is "debug" a message saying that the
	  pipeline has been created is logged.
	</li>
	<li>
	  element name "pipelines": set the <a href="#class-sitemap_config_parse-property-in_pipelines">in_pipelines</a> flag to False.
	</li>
	<li>
	  element name "components": set the <a href="#class-sitemap_config_parse-property-in_components">in_components</a> flag to False
	</li>
	<li>
	  if the element name is in the current server's <a href="#class-server_config-property-component_enames">component_enames</a> list, then it is the end of the
	  definition of a sitemap component. The reference to the component object at the end of the
	  <a href="#class-sitemap_config_parse-property-proc_comp_stack">proc_comp_stack</a> list
	  is removed. (This means that it is no longer the current parent element.)
	</li>
      </ul>
    </div></div><div id="class-sitemap_config_parse-property-sitemap" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">sitemap</div>
    <div style="margin-left:15px">
      The <a href="#class-sitemap_config">sitemap_config</a> instance which will be populated.
    </div>
  </div><div id="class-sitemap_config_parse-property-server" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">server</div>
    <div style="margin-left:15px">
      The current <a href="#class-server_config">server_config</a> instance.
    </div>
  </div><div id="class-sitemap_config_parse-property-proc_comp_stack" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">proc_comp_stack</div>
    <div style="margin-left:15px">
      a list of references to components which have been created from the sitemap XML configuration
      file.  This list is used as a stack whose last element is always the current "parent"
      component and where the element at position <span style="font-style:italic">n-1</span> is the parent of the
      component at position <span style="font-style:italic">n</span> and where the component at position 0 is
      always the current pipeline being processed. When a new component is created, it uses the last
      element in this list as its parnet component and then appends itself to the end of this list
      to become the new current parent. When the closing tag of a component's definition in the
      sitemap is read, the last element from this list is removed because it is no longer the
      current parent element. When a new pipeline component is created, it assigns itself as the
      first element of this list and therefore becomes the default parent element of all its child
      components.
    </div>
  </div><div id="class-sitemap_config_parse-property-in_components" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">in_components</div>
    <div style="margin-left:15px">
      a boolean flag which is True while the child elements of the &lt;components&gt; element are
      being processed.
    </div>
  </div><div id="class-sitemap_config_parse-property-in_pipelines" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">in_pipelines</div>
    <div style="margin-left:15px">
      a boolean flag which is True while the child elements of the &lt;pipelines&gt; element are
      being processed.
    </div>
  </div></div>

<div class="class" id="class-interpolation_syntax" style="border-top:1px solid #000000;border-bottom:1px solid #000000;margin-top:5px"><div style="font-size:120%;font-style:italic;margin-top:10px;margin-bottom:10px">interpolation_syntax</div><table><tr><td style="font-weight:bold">source</td><td style="font-family:monospace;background-color:#FFF0D8">pycoon/interpolation.py</td></tr></table><p>
    Base class for all interpolation classes.
  </p><div id="class-interpolation_syntax-method-__init__" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">__init__(self, pattern, component=None)</div>
      <p>
	Class constructor. <span style="font-style:italic">pattern</span> is a regular expression string used to
	match the syntax of {} delimited expressions in component attribute
	values. <span style="font-style:italic">component</span> is a <a href="#class-sitemap_config">sitemap</a>
	or <a href="#class-server_config">server</a> instance.
      </p>
    </div><div id="class-interpolation_syntax-method-_match" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">_match(self, instruction)</div><table style="margin-left:15px"><tr><td style="font-weight:bold">returns</td><td style="background-color:#FFF0D8">
      Returns a boolean.
    </td></tr></table><div style="margin-left:15px">
      <p>
	Matches a string against a pattern. <span style="font-style:italic">instruction</span> is the contents of
	a {} delimited interpolation instruction from a component attribute value; it will have been
	extracted by the <a href="#class-interpolation_syntax-helper_func-interpolate">interpolate</a> function.
      </p>
      <p>
	This method just calls the <a href="#class-interpolation_syntax-property-pattern">pattern</a> property's match() method with the given
	<span style="font-style:italic">instruction</span> and returns True if it matches, or False if it doesn't.
      </p>
    </div></div><div id="class-interpolation_syntax-method-__call__" style="margin-bottom:5px;background-color:#E2F6FF"><div style="font-weight:bold">__call__(self, instruction, uri_matcher, context)</div><table style="margin-left:15px"><tr><td style="font-weight:bold">returns</td><td style="background-color:#FFF0D8">
      Returns a 2-tuple which consists of a boolean flag which is True if the given
      <span style="font-style:italic">instruction</span> matched the object's pattern; and a string containing the
      result of performing the interpolation.
    </td></tr></table><div style="margin-left:15px">
      <p>
	Performs the interpolation. <span style="font-style:italic">instruction</span> is the text from inside the
	{} delimited instruction in the component attribute value;
	<span style="font-style:italic">uri_matcher</span> is the calling object's parent <a href="#class-uri_matcher">uri_matcher</a> (or <a href="#class-error_matcher">error_matcher</a>)
	component; <span style="font-style:italic">context</span> is either a <a href="#class-sitemap_config">sitemap</a> or <a href="#class-server_config">server</a>.
      </p>
      <p>
	This is where derived components should implement their functionality. The default behaviour
	raises a <span style="font-style:italic">NotImplemented</span> exception.
      </p>
    </div></div><div id="class-interpolation_syntax-property-pattern" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">pattern</div>
    <div style="margin-left:15px">
      A compiled regular expression object used to match the syntax of {} delimited expressions in
      component attribute values.
    </div>
  </div><div id="class-interpolation_syntax-property-component" style="margin-bottom:5px;background-color:#FCFFAA">
    <div style="font-weight:bold">component</div>
    <div style="margin-left:15px">
      a <a href="#class-sitemap_config">sitemap</a> or <a href="#class-server_config">server</a>
      instance.
    </div>
  </div><div id="class-interpolation_syntax-helper_func-register_interpolation_syntax" style="margin-bottom:5px;background-color:#E0DEFF">
    <div style="font-weight:bold">register_interpolation_syntax(server, syntax, name)</div><div style="margin-left:15px;margin-top:5px;font-style:italic">helper function</div>
    <div style="margin-left:15px">
      <span style="font-style:italic">server</span> is a <a href="#class-server_config">server_config</a>
      instance; <span style="font-style:italic">syntax</span> is an <a href="#class-interpolation_syntax">interpolation_syntax</a> instance;
      <span style="font-style:italic">name</span> is a name for the interpolation syntax. The function adds the
      given <span style="font-style:italic"> interpolation_syntax</span> to the server's <a href="#class-server_config-property-interpolation_syntaxes">interpolation_syntaxes</a>
      dictionary using the given <span style="font-style:italic">name</span> as an index.
    </div>
  </div><div id="class-interpolation_syntax-helper_func-interpolate" style="margin-bottom:5px;background-color:#E0DEFF">
    <div style="font-weight:bold">interpolate(component, string_arg, as_filename=False, root_path="")</div><div style="margin-left:15px;margin-top:5px;font-style:italic">helper function</div>
    <div style="margin-left:15px"><span style="font-weight:bold">returns</span><span>
      Returns the interpolated string.
    </span></div>
    <div style="margin-left:15px">
      <p>
	Takes a component attribute value, interprets the special {} delimited syntax and returns
	the interpolated string. <span style="font-style:italic">component</span> is the componet object which
	called the function; <span style="font-style:italic">string_arg</span> is the component attribute value
	which includes the {} delimited instructions; <span style="font-style:italic">as_filename</span> is a
	boolean which, when True, will cause the function to return an absolute file path by
	prepending the value of <span style="font-style:italic">root_path</span> to the result; if
	<span style="font-style:italic">root_path</span> is not supplied, the give
	<span style="font-style:italic">component</span>'s <a href="#class-component-property-root_path">root_path</a> is used.
      </p>
      <p>
	First, this function attempts to find the given <span style="font-style:italic">component</span>'s parent
	<a href="#class-uri_matcher">uri_matcher</a> or <a href="#class-error_matcher">error_matcher</a>. If it can't find one, it raises an
	exception. (The uri_matcher is needed in order to retrieve information about the request
	URI.) Next it initialises the result string with the <span style="font-style:italic">root_path</span> (if
	<span style="font-style:italic">as_filename</span> was True). Next it loops over the characters in the
	given <span style="font-style:italic">string_as</span>. If a character is outside a {}, it is simply added
	to the result string.  When it finds characters inside a pair of {}s, it begins looping over
	the available <a href="#class-server_config-property-interpolation_syntaxes">interpolation_syntaxes</a>. When it finds one which
	matches the given syntax, it inserts its result into the return string in place of the {}
	delimited instruction. If it doesn't find a matching interpolation_syntax, the {} delimited
	instruction is replaced with nothing.
      </p>
    </div>
  </div></div>

</div>


</div>

</body>
</html>
